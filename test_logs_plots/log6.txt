last layer mobilenet




C:\Users\canse\AppData\Local\Programs\Python\Python312\python.exe C:\Users\canse\Desktop\project\codepart23.py 
2025-01-20 21:05:15.314874: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-01-20 21:05:17.011845: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
Found 1933 images belonging to 20 classes.
Found 477 images belonging to 20 classes.
2025-01-20 21:05:22.154045: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
C:\Users\canse\AppData\Local\Programs\Python\Python312\Lib\site-packages\keras\src\trainers\data_adapters\py_dataset_adapter.py:121: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.
  self._warn_if_super_not_called()
Epoch 1/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 61s 962ms/step - accuracy: 0.3415 - loss: 2.5524 - val_accuracy: 0.8260 - val_loss: 0.6629
Epoch 2/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 58s 949ms/step - accuracy: 0.7785 - loss: 0.7353 - val_accuracy: 0.8805 - val_loss: 0.4048
Epoch 3/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 57s 943ms/step - accuracy: 0.8591 - loss: 0.4403 - val_accuracy: 0.9161 - val_loss: 0.3080
Epoch 4/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 58s 944ms/step - accuracy: 0.8841 - loss: 0.3676 - val_accuracy: 0.9203 - val_loss: 0.2838
Epoch 5/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 57s 939ms/step - accuracy: 0.9121 - loss: 0.2893 - val_accuracy: 0.9476 - val_loss: 0.2141
Epoch 6/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 59s 962ms/step - accuracy: 0.9123 - loss: 0.2962 - val_accuracy: 0.9413 - val_loss: 0.2115
Epoch 7/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 61s 1s/step - accuracy: 0.9409 - loss: 0.2028 - val_accuracy: 0.9392 - val_loss: 0.2104
Epoch 8/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 58s 957ms/step - accuracy: 0.9444 - loss: 0.1951 - val_accuracy: 0.9350 - val_loss: 0.2104
Epoch 9/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 61s 1s/step - accuracy: 0.9420 - loss: 0.1756 - val_accuracy: 0.9518 - val_loss: 0.2112
Epoch 10/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 61s 997ms/step - accuracy: 0.9544 - loss: 0.1468 - val_accuracy: 0.9602 - val_loss: 0.1560
Epoch 11/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 57s 938ms/step - accuracy: 0.9579 - loss: 0.1474 - val_accuracy: 0.9476 - val_loss: 0.1655
Epoch 12/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 58s 952ms/step - accuracy: 0.9562 - loss: 0.1449 - val_accuracy: 0.9287 - val_loss: 0.2250
Epoch 13/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 59s 963ms/step - accuracy: 0.9599 - loss: 0.1296 - val_accuracy: 0.9455 - val_loss: 0.1758
Epoch 14/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 57s 941ms/step - accuracy: 0.9586 - loss: 0.1310 - val_accuracy: 0.9371 - val_loss: 0.1862
Epoch 15/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 60s 992ms/step - accuracy: 0.9535 - loss: 0.1200 - val_accuracy: 0.9497 - val_loss: 0.1627
Epoch 16/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 60s 993ms/step - accuracy: 0.9668 - loss: 0.1080 - val_accuracy: 0.9623 - val_loss: 0.1536
Epoch 17/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 61s 997ms/step - accuracy: 0.9737 - loss: 0.0880 - val_accuracy: 0.9476 - val_loss: 0.1737
Epoch 18/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 62s 1s/step - accuracy: 0.9572 - loss: 0.1080 - val_accuracy: 0.9602 - val_loss: 0.1341
Epoch 19/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 61s 992ms/step - accuracy: 0.9564 - loss: 0.1268 - val_accuracy: 0.9434 - val_loss: 0.2117
Epoch 20/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 63s 1s/step - accuracy: 0.9605 - loss: 0.1251 - val_accuracy: 0.9413 - val_loss: 0.1881
Epoch 21/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 63s 1s/step - accuracy: 0.9545 - loss: 0.1185 - val_accuracy: 0.9539 - val_loss: 0.1842
Epoch 22/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 64s 1s/step - accuracy: 0.9691 - loss: 0.0891 - val_accuracy: 0.9497 - val_loss: 0.1603
Epoch 23/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 62s 1s/step - accuracy: 0.9674 - loss: 0.1014 - val_accuracy: 0.9560 - val_loss: 0.1486
Epoch 24/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 57s 941ms/step - accuracy: 0.9823 - loss: 0.0705 - val_accuracy: 0.9497 - val_loss: 0.1683
Epoch 25/25
61/61 ━━━━━━━━━━━━━━━━━━━━ 59s 974ms/step - accuracy: 0.9749 - loss: 0.0855 - val_accuracy: 0.9539 - val_loss: 0.1954
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 1s/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 572ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 601ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 577ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 568ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 568ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 570ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 578ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 591ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 564ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 565ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 655ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 570ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 575ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 1s/step

Overall Accuracy: 0.9455

Overall Metrics:
True Positives: 451
False Positives: 26
True Negatives: 9037
False Negatives: 26

Metrics for each class:

Class 0:
Precision: 1.0000
Recall: 0.9500
F1-score: 0.9744

Class 1:
Precision: 0.9412
Recall: 1.0000
F1-score: 0.9697

Class 2:
Precision: 1.0000
Recall: 0.8000
F1-score: 0.8889

Class 3:
Precision: 0.8636
Recall: 0.9500
F1-score: 0.9048

Class 4:
Precision: 1.0000
Recall: 1.0000
F1-score: 1.0000

Class 5:
Precision: 0.9268
Recall: 0.9870
F1-score: 0.9560

Class 6:
Precision: 0.9444
Recall: 0.8500
F1-score: 0.8947

Class 7:
Precision: 0.8636
Recall: 0.9500
F1-score: 0.9048

Class 8:
Precision: 1.0000
Recall: 1.0000
F1-score: 1.0000

Class 9:
Precision: 1.0000
Recall: 1.0000
F1-score: 1.0000

Class 10:
Precision: 1.0000
Recall: 1.0000
F1-score: 1.0000

Class 11:
Precision: 0.9524
Recall: 1.0000
F1-score: 0.9756

Class 12:
Precision: 1.0000
Recall: 0.8500
F1-score: 0.9189

Class 13:
Precision: 1.0000
Recall: 1.0000
F1-score: 1.0000

Class 14:
Precision: 0.9048
Recall: 0.9500
F1-score: 0.9268

Class 15:
Precision: 0.9091
Recall: 0.8696
F1-score: 0.8889

Class 16:
Precision: 0.8261
Recall: 0.9500
F1-score: 0.8837

Class 17:
Precision: 0.8947
Recall: 0.8500
F1-score: 0.8718

Class 18:
Precision: 1.0000
Recall: 1.0000
F1-score: 1.0000

Class 19:
Precision: 1.0000
Recall: 0.8000
F1-score: 0.8889

Weighted Average Metrics:
Precision: 0.9484
Recall: 0.9455
F1-score: 0.9450

Detailed Classification Report:
              precision    recall  f1-score   support

           0       1.00      0.95      0.97        20
           1       0.94      1.00      0.97        32
           2       1.00      0.80      0.89        20
           3       0.86      0.95      0.90        20
           4       1.00      1.00      1.00        20
           5       0.93      0.99      0.96        77
           6       0.94      0.85      0.89        20
           7       0.86      0.95      0.90        20
           8       1.00      1.00      1.00        20
           9       1.00      1.00      1.00        20
          10       1.00      1.00      1.00        20
          11       0.95      1.00      0.98        20
          12       1.00      0.85      0.92        20
          13       1.00      1.00      1.00        23
          14       0.90      0.95      0.93        20
          15       0.91      0.87      0.89        23
          16       0.83      0.95      0.88        20
          17       0.89      0.85      0.87        20
          18       1.00      1.00      1.00        22
          19       1.00      0.80      0.89        20

    accuracy                           0.95       477
   macro avg       0.95      0.94      0.94       477
weighted avg       0.95      0.95      0.94       477


Process finished with exit code 0
